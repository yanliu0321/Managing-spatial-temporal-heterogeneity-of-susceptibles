function d=kuzdist(par1,data)
%Sr0_total=24750000;%总人口
%R0=0;%初始恢复者
%par2=[Sr0_total R0];
% beta=par1(1);
% gam=par1(2);
% K=par1(3);
% I0=par1(4);
% Se0=par1(5);
% ydata=[(1:129)',data1(2,2:end)'];ylabels={'time','newly_infected'};
% zdata=par2';zlabels={'par2'};
% data=struct('ydata',ydata,'zdata',zdata);

par2=data.zdata(:,1);datanew=data.ydata(2:end,2);
X0=[par1(4),par1(3),par2(2),5,par2(1)-par1(4)];
[t,x]=ode45(@SIRmodel,1:129,X0,[],par1,par2);

newly_infected=diff(x(:,4));
d1=sqrt(sum((newly_infected-datanew).^2));

rate=par1(2).*par1(1).*x(:,2).*x(:,5)./par2(1);
Frate=[0	-6	-8	-6	-8	-8	-8	-10	-8	-12	-12	-16	-18	-24	-28	-38	-48	-62	-80	-104	-136	-178	-230	-302	-392	-510	-662	-858	-1110	-1432	-1834	-2346	-2982	-3756	-4688	-5798	-7072	-8498	-10044	-11652	-13254	-14770	-16134	-17270	-18114	-18662	-18912	-18854	-18502	-17908	-17114	-16148	-15052	-13856	-12602	-11314	-10024	-8744	-7490	-6284	-5140	-4072	-3086	-2184	-1426	-872	-586	-628	-1056	-1548	-1900	-2188	-2424	-2606	-2750	-2856	-2942	-2994	-3016	-3010	-2984	-2942	-2890	-2834	-2782	-2734	-2680	-2606	-2534	-2456	-2376	-2296	-2218	-2142	-2066	-1988	-1912	-1834	-1758	-1684	-1610	-1542	-1478	-1412	-1350	-1288	-1228	-1168	-1110	-1058	-1004	-954	-906	-860	-816	-772	-732	-692	-654	-616	-584	-550	-520	-490	-462	-436	-408	-386	-362];
d2=sqrt(sum((rate+Frate).^2));
d=0.99*d1+0.01*d2;

